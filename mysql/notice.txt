mysql> create database notice charset=utf8;

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| notice             |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)

mysql> drop database notice;

mysql> use notice;
Database changed
mysql> show tables;
Empty set (0.01 sec)

mysql> select database();
+------------+
| database() |
+------------+
| notice     |
+------------+
1 row in set (0.00 sec)

mysql> create table note( 字段 类型 约束
    -> id int auto_increment primary key not null,# 整型 自动增长 主键 非空
    -> name varchar(10) not null,# 可变字符串 非空
    -> gender bit default 1,	# 一个字节0和1，默认1，这里1不能加小括号
    -> birthday datetime);	# 日期时间


mysql> desc note;	# 查看表结构

mysql> alter table note add isDelete bit default 0;	# 增加列，逻辑删除列isDelete,default=0


alter table 表名 add|change|drop 列名 类型;	# 列名不能改
show create table 表名;	# 查看表的创建语句

==================================================================================
对表的操作
# 增
select * from note;
insert into note(0,'名字',1,'1999-1-1',0);	# 添加内容，单行
insert into note(name) values '名字';		# 添加字段名字，其他都是默认，单行
insert into note(gender,name) values(0,'名字');	# 添加多个字段(不管排序)，单行
insert into note(name) values('name1'),('name2'),('name3'); # 多个名字，即多行添加
insert into note(列1,...) values(值1,...),(值2,...)...;	# 多列多行，多值
mysql> insert into note(name,gender,birthday) values('cng',1,'38-1-1'),('wm',0,'50-2-2'),('cnx',1,'36-1-2');
# 改
update 表名 set 列1=new value,列2=new value... where id=num;
# 删
delete from note where id=num;	# 物理删除,需謹慎
update note set isDelete=1 where id=num;	# 逻辑删除
select * from note where isDelete=0;	# 查看未逻辑刪除的

===================================================================================

# 备份
sudo -s
cd /var/lib/mysql
mysqldump -uroot -p 表名 > path/filename.sql
exit
把這個備份拿到新的服務器，恢复時
creat database newnotice charset=utf8;	# 先创建新的库
mysql -uroot -p newnotice < Desktop/bak.sql # 导入
use newnotice;
select * from note;

===================================================================================
查
select id,name form note;	# 筛选
select distinct gender from note;	# 消除重复行
select distinct id,gender from note;
where
select * from note where id>3;	# id<=num
select * from note where name!='name'; # 不是谁
select * from note where isDelete=0;	# 都要基于这个查询，就是逻辑没有删除的
mysql> select * from note where id>3 and gender=0;
mysql> select * from note where id<4 or isDelete=0;

模糊查询
mysql> select * from note where name like '陈%';# 多个字符
mysql> select * from note where name like '陈_';# 单个字符
mysql> select * from note where name like '陈%' or name like '%龙%';

范围
mysql> select * from note where id in(2,3,5);
mysql> select * from note where id between 3 and 7;
mysql> select * from note where id between 3 and 7 and gender=1;

空，非空
mysql> select * from note where birthday is null;
mysql> select * from note where birthday is not null and gender=0;

聚合
select count(*) from note;	# 总数
select count(*) from note where isDelete=0;
select min(id) from note where isDelete=0 and gender=0;
select max(id) from note where gender=0;
select * from note where id=(select min(id) from note where isDelete=0 and gender=0);

select sum(id) from note where gender=1;	# 和
select avg(id) from note where gender=0 and isDelete=0; # 平均值

分组
select count(*) from note group by gender;
select gender,count(*) from note group by gender;	# 按性别，比上一句返回结果好

分组后筛选
select gender,count(*) from note group by gender having gender=0;	# 按性别统计后再按性别筛选
select gender,count(*) from note group by gender having count(*)>2;	# 按性别统计后再按统计数量筛选
# 上面这句显示男女统计数量结果大于2的成员
select gender,count(*) as rs from note group by gender having rs>3;	# 给统计结果取别名，给后面的筛选方便使用
# 上面这句显示男女统计数量结果大于3的成员

排序
select * from note where isDelete=0 and gender=1 order by id desc;	# 降序

alter table tablename add isdelete bit default 0; # 增加逻辑删除字段isdelete
update tablename set isdelete=1 where 字段名 in('name1','name2'); # 修改两个名字的逻辑删除值

select * from note where isDelete=0 and gender=1 order by name asc;			# 升序
select * from note where isDelete=0 and gender=1 order by name;	# 未逻辑删除男性按名字首字母升序排序
# 升序时，asc可省略不写

获取部分行
分页
select * from note limit 2,1;	# 从索引2开始，取一行
select * from note where isDelete=0 limit 1,3; # 未逻辑删除的从索引值1开始，取三行
已知：每页显示m条数据，当前是第n页
求总页数：
	-查询总条数p1
	-使用p1除以m得到p2
	-如果整除，p2为总数页
	-如果不整除，p2+1为总页数
求第n页的数据（什么乱七八糟看不懂）
看这里的解决办法：
公式：(n-1)*m,m
求证：n=3
第一页：0,1,2,3,4	(3-1)*5
第二页：5,6,7,8,9	(3-1)*5
第三页：10,11,12,13,14	(3-1)*5

0,1,2	(3-1)*3
3,4,5	(3-1)*3
6,7,8	(3-1)*3
实例：每页显示10条数据，那现在要取第9页的数据：
select * from 表名 where isdelete=0 limit (9-1)*10,10；
select * from 表名 where isdelete=0 limit 80,10;	# 即从索引值80开始，取10行

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
总结：
完整的select语句：编写顺序
select distinct * from 表名 where ...
			   group by ... having ...
			   order by ...
			   limit start,count

执行顺序为：
	from 表名
	where ...
	group by ...
	select distinct *
	having ...
	order by ...
	limit start,count

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++==
高级：关系存储
新建3个表
学生表：id,name
成绩表：id,score,学生,科目
科目表：id,title
mysql> create table students(
    -> id int auto_increment primary key not null,
    -> name varchar(10) not null);

mysql> create table subjects(
    -> id int auto_increment primary key not null,
    -> title varchar(10) not null);

mysql> create table scores(
    -> id int auto_increment primary key not null,
    -> score decimal(4,1),
    -> stuid int,
    -> subid int,
    -> foreign key(stuid) references students(id),
    -> foreign key(subid) references subjects(id));

 Cannot add foreign key constraint无法添加外键约束
1，两张表里要设主键和外键的字段的数据类型或者数据长度不一样 
2，某个表里已经有记录了

insert into scores values(0,100,1,1);无法添加或更新子行: 外键约束失败
Cannot add or update a child row: a foreign key constraint fails (`guanxi`.`scores`, CONSTRAINT `scores_ibfk_1` FOREIGN KEY (`stuid`) REFERENCES `students` (`id`))
mysql> desc scores;

select students.name,subjects.title,scores.score
from scores
inner join students on scores.stuid=students.id
inner join subjects on scores.subid=subjects.id;
+------+---------+-------+
| name | title   | score |
+------+---------+-------+
| xhm  | yuwen   | 100.0 |
| azg  | yuwen   |  98.0 |
| azg  | English |  99.0 |
| azg  | php     |  93.0 |
| azg  | java    |  50.0 |
| azg  | shuxue  |  32.0 |
| azg  | php     |  78.0 |
| cxy  | python  |  80.0 |
| xsc  | shuxue  |  89.0 |
+------+---------+-------+

select students.name,subjects.title,scores.score
from students
inner join scores on scores.stuid=students.id
inner join subjects on scores.subid=subjects.id;

select *
from scores
inner join students on students.id=scores.stuid; # inner

+----+-------+-------+-------+----+------+
| id | score | stuid | subid | id | name |
+----+-------+-------+-------+----+------+
|  3 | 100.0 |     1 |     1 |  1 | xhm  |
|  4 |  98.0 |     2 |     1 |  2 | azg  |
|  5 |  99.0 |     2 |     3 |  2 | azg  |
|  7 |  93.0 |     2 |     5 |  2 | azg  |
|  8 |  50.0 |     2 |     6 |  2 | azg  |
| 10 |  32.0 |     2 |     2 |  2 | azg  |
| 11 |  78.0 |     2 |     5 |  2 | azg  |
|  6 |  80.0 |     3 |     4 |  3 | cxy  |
|  9 |  89.0 |     4 |     2 |  4 | xsc  |
+----+-------+-------+-------+----+------+

select *
from scores
left join students on students.id=scores.stuid;

+----+-------+-------+-------+------+------+
| id | score | stuid | subid | id   | name |
+----+-------+-------+-------+------+------+
|  3 | 100.0 |     1 |     1 |    1 | xhm  |
|  4 |  98.0 |     2 |     1 |    2 | azg  |
|  5 |  99.0 |     2 |     3 |    2 | azg  |
|  6 |  80.0 |     3 |     4 |    3 | cxy  |
|  7 |  93.0 |     2 |     5 |    2 | azg  |
|  8 |  50.0 |     2 |     6 |    2 | azg  |
|  9 |  89.0 |     4 |     2 |    4 | xsc  |
| 10 |  32.0 |     2 |     2 |    2 | azg  |
| 11 |  78.0 |     2 |     5 |    2 | azg  |
+----+-------+-------+-------+------+------+

select *
from scores
right join students on students.id=scores.stuid;

+------+-------+-------+-------+----+-------+
| id   | score | stuid | subid | id | name  |
+------+-------+-------+-------+----+-------+
|    3 | 100.0 |     1 |     1 |  1 | xhm   |
|    4 |  98.0 |     2 |     1 |  2 | azg   |
|    5 |  99.0 |     2 |     3 |  2 | azg   |
|    7 |  93.0 |     2 |     5 |  2 | azg   |
|    8 |  50.0 |     2 |     6 |  2 | azg   |
|   10 |  32.0 |     2 |     2 |  2 | azg   |
|   11 |  78.0 |     2 |     5 |  2 | azg   |
|    6 |  80.0 |     3 |     4 |  3 | cxy   |
|    9 |  89.0 |     4 |     2 |  4 | xsc   |
| NULL |  NULL |  NULL |  NULL |  5 | laoge |
| NULL |  NULL |  NULL |  NULL |  6 | zhan  |
| NULL |  NULL |  NULL |  NULL |  7 | qiang |
+------+-------+-------+-------+----+-------+

select *
from students
left join scores on students.id=scores.stuid;
+----+-------+------+-------+-------+-------+
| id | name  | id   | score | stuid | subid |
+----+-------+------+-------+-------+-------+
|  1 | xhm   |    3 | 100.0 |     1 |     1 |
|  2 | azg   |    4 |  98.0 |     2 |     1 |
|  2 | azg   |    5 |  99.0 |     2 |     3 |
|  2 | azg   |    7 |  93.0 |     2 |     5 |
|  2 | azg   |    8 |  50.0 |     2 |     6 |
|  2 | azg   |   10 |  32.0 |     2 |     2 |
|  2 | azg   |   11 |  78.0 |     2 |     5 |
|  3 | cxy   |    6 |  80.0 |     3 |     4 |
|  4 | xsc   |    9 |  89.0 |     4 |     2 |
|  5 | laoge | NULL |  NULL |  NULL |  NULL |
|  6 | zhan  | NULL |  NULL |  NULL |  NULL |
|  7 | qiang | NULL |  NULL |  NULL |  NULL |
+----+-------+------+-------+-------+-------+

select *
from students
right join scores on students.id=scores.stuid;
+------+------+----+-------+-------+-------+
| id   | name | id | score | stuid | subid |
+------+------+----+-------+-------+-------+
|    1 | xhm  |  3 | 100.0 |     1 |     1 |
|    2 | azg  |  4 |  98.0 |     2 |     1 |
|    2 | azg  |  5 |  99.0 |     2 |     3 |
|    3 | cxy  |  6 |  80.0 |     3 |     4 |
|    2 | azg  |  7 |  93.0 |     2 |     5 |
|    2 | azg  |  8 |  50.0 |     2 |     6 |
|    4 | xsc  |  9 |  89.0 |     4 |     2 |
|    2 | azg  | 10 |  32.0 |     2 |     2 |
|    2 | azg  | 11 |  78.0 |     2 |     5 |
+------+------+----+-------+-------+-------+

select name,avg(score) from scores
inner join students on scores.stuid=students.id
group by stuid;

+------+------------+
| name | avg(score) |
+------+------------+
| xhm  |  100.00000 |
| azg  |   75.00000 |
| cxy  |   80.00000 |
| xsc  |   89.00000 |
+------+------------+

select name,avg(score) as avg1 from scores
inner join students on scores.stuid=students.id
group by stuid
order by avg1;

+------+-----------+
| name | avg1      |
+------+-----------+
| azg  |  75.00000 |
| cxy  |  80.00000 |
| xsc  |  89.00000 |
| xhm  | 100.00000 |
+------+-----------+

select distinct 列*
from 表1 inner|left|right| join 表2 on 表1与表2的关系
where ...
group by ... having ...
order by ...

=========================================================================
高阶
购物车：消费者 商品 数量 价格
商品信息：名称 价格 单位 日期

商品分类 1家电 2日化 3食品
商品	1电视2洗衣机3辣条4香皂5面包
1.确定实体间是否有关系
2.确定是几对几的关系
3.确定在哪个实体中建立字段

查询男生的姓名、总分
students.gender=1
students.name
sum(scores.score)
建立连接：students.id=scores.stuid
使用sum--->分组，姓名：每个人的总分

select name,sum(score)
from students
inner join scores on students.id=scores.stuid
group by students.id;
+------+------------+
| name | sum(score) |
+------+------------+
| xhm  |      100.0 |
| azg  |      450.0 |
| cxy  |       80.0 |
| xsc  |       89.0 |
+------+------------+

查询科目的名称、平均分
subjects.title
avg(scores.score)
连接：subjects.id=scores.subid
avg--->group by subjects.title

查询未删除科目的名称、最高分、平均分
where subjects.isdelete=(
subjects.title
max(scores.score)
avg(scores.score)
连接：subjects.id=scores.subid
max,avg--->group by subjects.title

==============================================================

设计省信息的表结构
省：id title
市：id title 
